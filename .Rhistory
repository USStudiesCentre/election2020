library(tidyverse)
library(here)
library(lubridate)
library(ussc)
library(tidyverse)
library(here)
library(lubridate)
library(ussc)
library(readxl)
library(tidyverse)
library(here)
library(lubridate)
library(ussc)
library(readxl)
polls <- read_xlsx(here("data/PrimaryPollsSince1980.xlsx"))
library(here)
dr_here
dr_here()
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"))
dim(polls)
head(polls)
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1)
head(polls)
table(polls$cycle)
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)])
## question is a unique identifier for poll
## answer_id is a unique identifier for candidate
table(polls$st,polls$cycle)
results <- read_xlsx(here::here("data/Presidential primary results, 1968-2016.xlsx"),
sheet = 1)
results
table(polls$contest)
polls <- polls %>%
left_join(results %>% select(contest,date))
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)])
results <- read_xlsx(here::here("data/Presidential primary results, 1968-2016.xlsx"),
sheet = 1)
## polls
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)])
## question is a unique identifier for poll
## answer_id is a unique identifier for candidate
table(polls$st,polls$cycle)
## write contest date onto polls
polls <- polls %>%
left_join(results %>% select(contest,date) %>% unique())
head(polls)
options(width=160)
head(polls)
?between
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)]) %>%
mutate(ex = interval(start_date,end_date),
mid_date = int_start(ex) + ((int_end(ex)-int_start(ex)/2))) %>%
select(-ex)
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)]) %>%
mutate(ex = interval(as_date(start_date),as_date(end_date)),
mid_date = int_start(ex) + ((int_end(ex)-int_start(ex)/2))) %>%
select(-ex)
polls <- read_xlsx(here::here("data/PrimaryPollsSince1980.xlsx"),sheet = 1) %>%
mutate(st=state.abb[match(state,state.name)]) %>%
mutate(ex = interval(as_date(start_date),as_date(end_date)),
mid_date = int_start(ex) + ((int_end(ex)-int_start(ex))/2)) %>%
select(-ex)
polls
polls %>% select(cycle,mid_date)
